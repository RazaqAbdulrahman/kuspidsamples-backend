services:
  - type: web
    name: kuspidsamples-api
    plan: starter
    branch: main
    runtime: docker

    buildCommand: mvn clean package -DskipTests
    startCommand: java -jar target/kuspidsamples-backend-0.0.1-SNAPSHOT.jar

    autoDeploy: true

    envVars:
      # Spring / App Config
      - key: SPRING_PROFILES_ACTIVE
        value: prod

      # Security
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRATION
        value: "3600000"

      # Cloudinary (must not be null)
      - key: CLOUDINARY_CLOUD_NAME
        value: ""
        sync: false
      - key: CLOUDINARY_API_KEY
        value: ""
        sync: false
      - key: CLOUDINARY_API_SECRET
        value: ""
        sync: false

      # Database Connection
      - key: DATABASE_URL
        fromDatabase:
          name: kuspidsamples-db
          property: connectionString

databases:
  - name: kuspidsamples-db
    plan: starter
    databaseName: kuspidsamples
    user: kuspidsamples
