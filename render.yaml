services:
  - type: web
    name: kuspidsamples-api
    plan: starter
    branch: main
    runtime: docker
    # Remove buildCommand - Docker handles this
    # Health check configuration
    healthCheckPath: /health
    autoDeploy: true

    envVars:
      # Spring / App Config
      - key: SPRING_PROFILES_ACTIVE
        value: prod

      # Security
      - key: JWT_SECRET
        generateValue: true

      - key: JWT_EXPIRATION
        value: "3600000"

      # Cloudinary - YOU MUST SET THESE IN RENDER DASHBOARD
      # Go to your service -> Environment -> Add these manually
      - key: CLOUDINARY_CLOUD_NAME
        sync: false

      - key: CLOUDINARY_API_KEY
        sync: false

      - key: CLOUDINARY_API_SECRET
        sync: false

      # Frontend URL for CORS
      - key: FRONTEND_URL
        value: "https://kuspidsamples.onrender.com"

      # Database Connection - Render auto-injects this
      - key: DATABASE_URL
        fromDatabase:
          name: kuspidsamples-db
          property: connectionString

databases:
  - name: kuspidsamples-db
    plan: starter
    databaseName: kuspidsamples
    user: kuspidsamples